<!DOCTYPE html>
<html>
<head>
    <title>RAPydity Instructions</title>
    <link rel="icon" type="image/gif" href="R_logo3.gif">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1, h2 {
            color: #2c3e50;
        }
        .note {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
        }
        .highlight {
            background-color: #fffacd;
            border-left: 4px solid #ffa500;
            padding: 15px;
            margin: 15px 0;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="R_logo3.gif" alt="RAPydity Logo" style="max-width: 150px;">
        <h1>RAPydity v2.0.0 - RAP Processing Tool</h1>
    </div>

    <p>RAPydity is a tool for processing Reasonable Adjustment Plans (RAPs) and applying extra time accommodations to Canvas assignments. As of v2.0, RAP data is read from a single CSV file rather than individual PDF files.</p>

    <h2>Installation</h2>
    <ol>
        <li>
            <strong>Python Installation</strong>
            <ul>
                <li>Make sure Python 3.8 or later is installed on your computer</li>
                <li>You can download Python from the Software Centre, the Microsoft Store, or directly from <a href="https://www.python.org/downloads/" target="_blank">python.org</a></li>
                <li>During installation, make sure to check "Add Python to PATH"</li>
            </ul>
        </li>

        <li>
            <strong>Download and Setup</strong>
            <ul>
                <li>Download RAPydity from the <a href="https://github.com/florianbreuer/rapydity/releases" target="_blank">releases page</a></li>
                <li>Extract the files to a folder of your choice</li>
                <li>Open a terminal/command prompt and navigate to the RAPydity folder</li>
                <li>Create and activate a virtual environment (recommended):
                    <ul>
                        <li>Windows:
                            <code>python -m venv venv</code> then
                            <code>venv\Scripts\activate</code>
                        </li>
                        <li>Mac/Linux:
                            <code>python3 -m venv venv</code> then
                            <code>source venv/bin/activate</code>
                        </li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <strong>Install Required Libraries</strong>
            <ul>
                <li>With your virtual environment activated, run:</li>
                <li>Run: <code>pip install PyPDF2 requests tk</code></li>
            </ul>
            <div class="note">
                <strong>Note:</strong> On most systems, tkinter comes pre-installed with Python.
                If you're using a virtual environment and tkinter is not found, you'll need to install it system-wide:
                <ul>
                    <li>On Ubuntu/Debian: <code>sudo apt-get install python3-tk</code></li>
                    <li>On Fedora: <code>sudo dnf install python3-tkinter</code></li>
                    <li>On Windows: Reinstall Python and make sure to select "tcl/tk and IDLE" during installation</li>
                </ul>
            </div>
        </li>

        <li>
            <strong>Run RAPydity</strong>
            <ul>
                <li>With your virtual environment activated, run:
                    <ul>
                        <li>Windows: <code>python rapydity.py</code></li>
                        <li>Mac/Linux: <code>python3 rapydity.py</code></li>
                    </ul>
                </li>
                <li>Note: Double-clicking <code>rapydity.py</code> won't work when using a virtual environment, as it would use the system Python instead</li>
            </ul>
        </li>
    </ol>

    <h2>Initial Setup</h2>
    <ol>
        <li>On first run, you'll need to:
            <ul>
                <li><strong>Enter your Canvas API access token</strong>
                    <ul>
                        <li>Go to Canvas &rarr; Account &rarr; Settings</li>
                        <li>Scroll down to "Approved Integrations"</li>
                        <li>Click "+ New Access Token"</li>
                        <li>Give it a purpose (e.g., "RAPydity")</li>
                        <li>Set an expiry date if desired (optional)</li>
                        <li>Click "Generate Token" and copy the token</li>
                        <li>Paste the token into RAPydity when prompted</li>
                        <li><strong>Important:</strong> Save this token somewhere safe as Canvas won't show it again</li>
                    </ul>
                </li>
                <li><strong>Select the RAP CSV File</strong>
                    <img src="ServiceNowScreenshot.png" alt="ServiceNow Screenshot" style="max-width: 100%; margin: 10px 0;">
                    <ul>
                        <li>In the RAP view of your ServiceNow portal, click on "personalize fields" (red arrow) and make sure that
                            "Exam Time" is included, together with "Student Name" and "Student ID".</li>
                        <li>Export the data as a CSV file and save it somewhere convenient.</li>
                        <li>The CSV file should contain the columns:
                            <ul>
                                <li><code>u_student_id</code> - Student number prefixed by "C" (e.g., "C3472571")</li>
                                <li><code>u_exam_time</code> - Extra time allocation (e.g., "10 mins/hr.")</li>
                                <li><code>u_requested_for1</code> - Student's full name</li>
                            </ul>
                        </li>
                        <li>You can optionally select this file during initial setup, or you will be prompted on startup</li>
                        <li>You can change the file at any time using the "Change RAP File..." button</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li>The configuration will be saved in <code>config.ini</code></li>
    </ol>

    <h2>Course Management</h2>
    <ol>
        <li>Select a course from the dropdown menu at the top of the window
            <ul>
                <li>By default, only current courses are shown</li>
                <li>Uncheck "Show current courses only" to see past courses</li>
            </ul>
        </li>
        <li>Click "Manage Courses" to:
            <ul>
                <li>Refresh the course list from Canvas</li>
                <li>View all available courses</li>
            </ul>
        </li>
    </ol>

    <h2>Viewing Extra Time Data</h2>
    <ol>
        <li>Click "View Extra Time Data" to see all processed RAP information for the current course</li>
        <li>The viewer shows:
            <ul>
                <li>Student names and numbers</li>
                <li>Extra time allocations</li>
            </ul>
        </li>
        <li>Click any column header to sort the data</li>
        <li>This view is read-only - to update data, use "Update from RAP CSV"</li>
    </ol>

    <h2>RAP Processing</h2>
    <ol>
        <li><strong>From CSV (Primary Method)</strong>
            <ul>
                <li>Ensure the RAP CSV file is selected (see Initial Setup above, or use "Change RAP File...")</li>
                <li>Click "Update from RAP CSV" to:
                    <ul>
                        <li>Read student accommodations from the RAP CSV</li>
                        <li>Filter to only students enrolled in the selected course</li>
                        <li>Look up Canvas IDs for new students</li>
                        <li>Save the information to a course-specific data file</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><strong>From PDFs (Legacy Fallback)</strong>
            <ul>
                <li>If RAP data is provided as individual PDF files, click "Update from RAP PDFs"</li>
                <li>You will be prompted to select the folder containing the PDF files</li>
                <li>PDFs are parsed for student name, number, and extra time allocation</li>
            </ul>
        </li>
    </ol>

    <h2>Applying Extra Time</h2>
    <ol>
        <li>After processing RAPs, click "Apply Extra Time" to:
            <ul>
                <li>Select specific assignments to modify</li>
                <li>Apply extra time accommodations based on RAP data</li>
                <li>Verify student enrollments</li>
            </ul>
        </li>
        <li>
            <div class="highlight">
                <strong>Quick Action: "Just Do It" Button</strong>
                <p>For a streamlined workflow, use the <strong>&#10003; Just Do It!</strong> button to:</p>
                <ul>
                    <li>Update student data from the RAP CSV in one step</li>
                    <li>Automatically apply extra time to ALL quizzes in the course</li>
                    <li>Get a summary of actions performed</li>
                </ul>
                <p>This is ideal when you want to quickly process all RAPs and apply accommodations to all quizzes without selecting them individually.</p>
            </div>
        </li>
        <li>Extra time is calculated proportionally based on:
            <ul>
                <li>The student's RAP accommodation (e.g., 10 mins per hour)</li>
                <li>The quiz's time limit</li>
            </ul>
        </li>
    </ol>

    <h2>Application Features</h2>
    <ul>
        <li><strong>Course Selection:</strong>
            <ul>
                <li>"Show current courses only" checkbox filters out past courses</li>
                <li>Course list is automatically sorted alphabetically</li>
            </ul>
        </li>
        <li><strong>RAP File Management:</strong>
            <ul>
                <li>Use "Change RAP File..." to select a different RAP CSV file at any time</li>
                <li>The selected file path is remembered across sessions</li>
                <li>If the file is not found on startup, you will be prompted to select a new one</li>
            </ul>
        </li>
        <li><strong>Logging:</strong>
            <ul>
                <li>The log window shows important messages and actions</li>
                <li>Warnings appear with yellow highlighting</li>
                <li>Errors appear with red highlighting</li>
                <li>Use the "Clear Log" button to reset the log display</li>
                <li>All actions are still recorded in <code>rapydity.log</code> even after clearing</li>
            </ul>
        </li>
        <li><strong>Data Management:</strong>
            <ul>
                <li>Student data is stored in course-specific CSV files</li>
                <li>Changes are logged for accountability</li>
            </ul>
        </li>
    </ul>

    <h2>Troubleshooting</h2>
    <ul>
        <li><strong>Common Issues:</strong>
            <ul>
                <li>If students aren't being found from the RAP CSV:
                    <ul>
                        <li>Check that the CSV file contains the required columns: <code>u_student_id</code>, <code>u_exam_time</code>, <code>u_requested_for1</code></li>
                        <li>Verify that <code>u_student_id</code> values are in the format "C" followed by a 7-digit number (e.g., "C3472571")</li>
                        <li>Ensure <code>u_exam_time</code> contains a number for students who need extra time (e.g., "10 mins/hr.")</li>
                        <li>Students with empty <code>u_exam_time</code> or "No additional time required." are automatically skipped</li>
                    </ul>
                </li>
                <li>If Canvas integration isn't working:
                    <ul>
                        <li>Verify your API token hasn't expired</li>
                        <li>Check that students are enrolled in the correct course</li>
                        <li>Ensure you have appropriate permissions in Canvas</li>
                    </ul>
                </li>
                <li>If using legacy PDF processing:
                    <ul>
                        <li>Check that the PDF is readable and contains the required information</li>
                        <li>Verify the format matches: name in Title Case, surname in UPPERCASE, followed by 7-digit student number</li>
                        <li>Ensure the extra time specification is in the format "Extra time XX mins per hour"</li>
                    </ul>
                </li>
            </ul>
        </li>
        <li><strong>Logging and Debugging:</strong>
            <ul>
                <li>Check the log window for immediate feedback</li>
                <li>More detailed logs are in <code>rapydity.log</code></li>
                <li>Use "View Extra Time Data" to verify processed information</li>
            </ul>
        </li>
        <li><strong>File Access:</strong>
            <ul>
                <li>Ensure the RAP CSV file is accessible and not locked by another program</li>
                <li>Check that course data CSV files aren't open in other programs when updating</li>
                <li>Verify file paths don't contain special characters</li>
            </ul>
        </li>
    </ul>

    <hr style="margin-top: 40px;">
    <div style="font-size: 0.8em; color: #666; text-align: center; padding: 20px;">
        &copy; 2024 <a href="https://github.com/florianbreuer" target="_blank">Florian Breuer</a>. RAPydity is free software released under the <a href="https://opensource.org/licenses/MIT" target="_blank">MIT License</a>.
    </div>
</body>
</html>
